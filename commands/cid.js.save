const axios = require('axios');

module.exports = {
    name: 'cid',
    aliases: ['iid'],
   d   cooldown: 3,
    async execute(sock, msg, text, from) {
        const cleanedText = text.split(/\s+/).slice(1).join('').replace(/[^0-9]/g, '');
        if (!cleanedText) {
            await sock.sendMessage(from, { text: '‚ùå Please provide a valid Installation ID.' });
            return;
        }

        const apiKey = 't4CxiApPE1rjncOfuQHcD6F74';
        const url = `https://pidkey.com/ajax/cidms_api?iids=${cleanedText}&justforcheck=1&apikey=${apiKey}`;

        try {
            const { data } = await axios.get(url);
            if (data?.have_cid) {
                await sock.sendMessage(from, {
                    text: `‚úÖ *CID Found!*\n\nCID:\n${data.confirmation_id_with_dash}\nChecked: ${data.result}`
                });
            } else {
                await sock.sendMessage(from, {
                    text: `üîç *CID Check Result:*\nStatus: ${data.result || 'Unknown'}\nChecked: ${data.typeiid == 1 ? 'Retail' : 'Unknown'}`
                });
            }
        } catch (err) {
            console.error('‚ùå Error in cid:', err);
            await sock.sendMessage(from, {
                text: '‚ö†Ô∏è Error occurred while checking CID. Please try again later.'
            });
        }
    }
};
